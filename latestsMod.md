Files modified (10 files):                                                                                                                                                                                                                                                                                                                        
1. src/models.py — Replaced Category enum (MEC/PRO/CAL/SEG/LOG/OPS → 12 new categories), added TicketType enum, updated IncidentTemplate (added ticket_type, sla, requires_image), simplified IncidentRecord (added agency, ticket_type, sla; removed plant, line, work_cell, machine, production_order, lot_number, immediate_action),     removed line from UserProfile                                                                                                                                             
2. src/catalog/parser.py — Completely rewritten from markdown parser to Excel parser using openpyxl. Auto-generates codes (POS-001, IMP-001, etc.), maps categories and ticket types from Spanish text                                                                                                                                            
3. src/config.py — Changed CATALOG_PATH from incident_catalog.md to Incidentes.xlsx                                                                                       
4. src/graph/nodes.py — Simplified REQUIRED_FIELDS to just agency + description, updated _FIELD_MAP, updated all node functions (greeting, confirm_classification, confirmation, edit, save) to use new fields and domain language                                                                                                           
5. src/db/engine.py — Updated DDL: new incidents table schema with ticket_type, sla, agency; removed old columns; removed line from users                                 
6. src/db/repositories.py — Updated INSERT/upsert queries to match new schemas                                                                                            
7. src/prompts/templates/system.j2 — Changed from egg factory to lottery agency context                                                                                   
8. src/prompts/templates/classify.j2 — Updated domain context and code format examples                                                                                   
9. src/prompts/templates/confirm.j2 — Updated fields to match new model                                                                                                   
10. src/media/processor.py — Updated image analysis prompt to lottery agency context                                                                                                                                                                                                                                                                
Verification results
- Parser reads all 37 incidents from Incidentes.xlsx                                                                                                                      
- All 3 ticket types found: Incidente, Alerta, Reclamo                                                                                                                    
- All 12 categories present: CON, ELE, EQU, FRA, IMP, INF, MAT, NET, PAG, POS, REC, VEN                                                                                   
- DB initializes with correct schema (20 columns in incidents table)                                                                                                      
- Old chatbot.db deleted and recreated with new schema 